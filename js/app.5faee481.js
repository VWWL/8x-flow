(function(t){function e(e){for(var r,o,c=e[0],s=e[1],u=e[2],f=0,d=[];f<c.length;f++)o=c[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);l&&l(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={app:0},i=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},3131:function(t,e,n){},4207:function(t,e,n){"use strict";var r=n("3131"),a=n.n(r);a.a},4326:function(t,e,n){t.exports="https://vincentx.github.io/8x-flow/img/8x-flow-logo.785a7e0f.png"},4868:function(t,e,n){"use strict";var r=n("b804"),a=n.n(r);a.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{attrs:{id:"model-editor"}},[n("nav",{staticClass:"navbar",attrs:{role:"navigation","aria-label":"main navigation"}},[n("div",{staticClass:"navbar-brand"},[n("a",{staticClass:"navbar-item"},[n("img",{attrs:{src:t.logo,height:"28"}})]),t._m(0)]),n("div",{staticClass:"navbar-menu"},[n("div",{staticClass:"navbar-start"},[n("div",{staticClass:"navbar-item"},[n("div",{staticClass:"dropdown is-hoverable"},[t._m(1),n("div",{staticClass:"dropdown-menu",attrs:{id:"examples",role:"menu"}},[n("div",{staticClass:"dropdown-content"},t._l(t.examples,(function(e){return n("a",{key:e.name,staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(n){return t.loadExample(e.uri)}}},[t._v(" "+t._s(e.name)+" ")])})),0)])])])]),n("div",{staticClass:"navbar-end"},[n("div",{staticClass:"navbar-item"},[n("div",{staticClass:"buttons"},[n("a",{staticClass:"button",attrs:{id:"download-script"},on:{click:t.downloadScript}},[t._v(" Save Script ")]),n("a",{staticClass:"button",attrs:{id:"download-graph"},on:{click:t.downloadGraph}},[t._v(" Save Graph ")])])])])])]),n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-one-third has-background-dark"},[n("script-editor",{model:{value:t.yaml,callback:function(e){t.yaml=e},expression:"yaml"}})],1),n("div",{staticClass:"column is-two-thirds has-background-white-ter"},[n("model-viewer",{ref:"viewer",attrs:{graph:t.graph}})],1)])])},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a",{staticClass:"navbar-burger burger",attrs:{role:"button","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample"}},[n("span",{attrs:{"aria-hidden":"true"}}),n("span",{attrs:{"aria-hidden":"true"}}),n("span",{attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dropdown-trigger"},[n("button",{staticClass:"button",attrs:{"aria-haspopup":"true","aria-controls":"examples"}},[n("span",[t._v("Examples")])])])}],o=(n("d3b7"),n("96cf"),n("1da1")),c=(n("92c6"),n("4326")),s=n.n(c),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"script-editor"},[n("textarea",{ref:"textarea",staticClass:"script"})])},l=[],f=n("56b3"),d=n.n(f),p=(n("ced0"),n("8822"),n("a7be"),n("fade"),n("0dd0"),n("a4d3"),n("e01a"),n("d28b"),n("99af"),n("4de4"),n("4160"),n("caad"),n("c975"),n("a15b"),n("d81d"),n("13d5"),n("b0c0"),n("b64b"),n("ac1f"),n("25f0"),n("2532"),n("3ca3"),n("466d"),n("1276"),n("159b"),n("ddb0"),n("e9eb")),m=n.n(p),h={attr:{data:function(t){return y(t,"data")},timestamp:function(t){return y(t,"timestamp")}}};function v(t){function e(e){return function(n,r,a){return t.model({id:n,desc:r||"",archetype:e,attributes:a||[]})}}function n(e){return function(n,r){t.rel({source:n.id,target:r.id,type:e})}}return{model:{rfp:e("rfp"),proposal:e("proposal"),contract:e("contract"),evidence:e("evidence"),agreement:e("agreement"),party:e("party"),place:e("place"),thing:e("thing"),role:function(t,n){return e("role")(t,n||"",[])},domain:function(t,n){return e("domain")(t,n||"",[])},system:function(t,n){return e("system")(t,n||"",[])},details:e("details"),fulfillmentRequest:e("fulfillment"),fulfillmentConfirmation:function(t,n,r){return e(n?"variform":"fulfillment")(t,"",r)},participant:function(t){return e("participant")(t,"",[])}},rel:{details:n("has-details"),fulfillment:n("fulfillment"),confirmation:n("confirmation"),participant:n("participant"),plays:n("plays"),relates:n("relates"),evidence:n("as-evidence")},result:t.result}}function y(t,e){return{name:t,type:e}}var g={message:{malformed:function(t,e){return"".concat(t.id," has malformed ").concat(e," declaration")},required:function(t,e){return"".concat(t.id," must have ").concat(e," declaration")},roleRequired:function(t){return"".concat(t.id," can only play as roles")},mismatchArchetype:function(t,e){return"".concat(t.id," can not be redefined as '").concat(e.archetype,"'")}}};function b(t){return b="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function w(t){return"string"===typeof t||t instanceof String}function x(t){return"object"===b(t)&&!Array.isArray(t)}function k(t,e){return t?w(t)?{id:e,description:t}:(t.id=e,t):{id:e}}var _=/[ ]*,[ ]*/,j={required:{timestamp:function(t){return q(S(t),g.message.required(t,"key_timestamps"))(t.key_timestamps)}},name:function(t){return z(E,"")(t.name)},desc:function(t){return z(E,"")(t.desc)},timestamp:function(t){return z(S(t),[])(t.key_timestamps)},data:function(t){return z($(R(h.attr.data,g.message.malformed(t,"key_data"))),[])(t.key_data)},variform:function(t){return z(A,!1)(t.variform)},details:function(t,e){return O(t.details,C(e,t,"details",x))},fulfillment:function(t,e){return O(t.fulfillment,C(e,t,"fulfillment",x))},participants:function(t,e){return O(t.participants,C(e,t,"participants",(function(t){return!0})))},plays:function(t,e){return O(t.plays,C(e,t,"plays",(function(t){return!0})))},relates:function(t,e){return O(t.relates,C(e,t,"relates",(function(t){return!0})))},evidences:function(t,e){return O(t.evidences,C(e,t,"evidences",(function(t){return!0})))},role:{is:function(t){return t.match(/^_+.+/)},name:function(t){return t.split(/^_+/)[1]}}};function C(t,e,n,r){return function(a){if(w(a))return t(e,{id:a});if(1===Object.keys(a).length){var i=Object.keys(a)[0];if(!r(a[i]))throw g.message.malformed(e,n);return t(e,k(a[i],i))}throw g.message.malformed(e,n)}}function O(t,e){return z($(P(e)),[])(t)}function S(t){return function(e){return $(R(h.attr.timestamp,g.message.malformed(t,"key_timestamps")))(e)}}function A(t){return"boolean"===typeof t?t:["y","yes","ok","sure"].includes(E(t).toLowerCase())}function E(t){return t.toString()}function q(t,e){return function(n){if(!n)throw e;return t(n)}}function z(t,e){return function(n){return n?t(n):e}}function $(t){return function(e){return t(w(e)?e.split(_):e)}}function R(t,e){return function(n){if(!Array.isArray(n))throw e;return n.map(t)}}function P(t){function e(t){return Object.keys(t).map((function(e){var n={};return n[e]=t[e],n}))}return function(n){return(Array.isArray(n)?n:e(n)).forEach(t)}}function M(){var t={models:[],relationships:[]},e=[["system","role"],["domain","role"],["contract","evidence"],["agreement","evidence"],["proposal","evidence"],["rfp","evidence"],["fulfillment","evidence"],["variform","evidence"],["details","evidence"],["variform","role"],["contract","participant"],["agreement","participant"],["proposal","participant"],["rfp","participant"],["fulfillment","participant"],["variform","participant"],["evidence","participant"],["details","participant"],["system","participant"],["domain","participant"],["role","participant"],["party","participant"],["place","participant"],["thing","participant"]],n={};function r(t,n){function r(){function e(t){return t?t.length:0}t.attributes||(t.attributes=[]),n.attributes&&(t.attributes=t.attributes.concat(n.attributes)),e(t.desc)<e(n.desc)&&(t.desc=n.desc)}function a(){if(n.archetype&&n.archetype!==t.archetype){var r=e.filter((function(e){return e.includes(t.archetype)&&e.includes(n.archetype)}));if(0===r.length)throw g.message.mismatchArchetype(t,n);var a=r[0].indexOf(t.archetype),i=r[0].indexOf(n.archetype);a>i&&(t.archetype=n.archetype)}}return r(),a(),t}return{result:t,model:function(e){return n[e.id]?r(n[e.id],e):(t.models.push(e),n[e.id]=e,e)},rel:function(e){return t.relationships.push(e)}}}function T(t){var e=m.a.load(t),n=v(M());return Array.isArray(e)?e.forEach((function(t){return B(n,t)})):B(n,e),n.result}function B(t,e){e&&(["contract","rfp","proposal","evidence","agreement"].filter((function(t){return e[t]})).forEach((function(n){return L(t,k(e,e[n]),t.model[n])})),["party","place","thing"].filter((function(t){return e[t]})).forEach((function(n){return G(t,k(e,e[n]),t.model[n])})),["role","domain","system"].filter((function(t){return e[t]})).forEach((function(n){return H(t,k(e,e[n]),t.model[n])})),e["contract"]&&J(t,k(e,e.contract)),e["agreement"]&&J(t,k(e,e.agreement)))}function L(t,e,n){n(e.id,j.desc(e),U(j.required.timestamp(e),j.data(e))),V(t,e)}function V(t,e){j.details(e,F(t)),j.plays(e,N(t)),j.participants(e,I(t)),j.evidences(e,K(t))}function G(t,e,n){n(e.id,j.desc(e),j.data(e)),j.relates(e,D(t)),j.plays(e,N(t))}function H(t,e,n){n(e.id,j.desc(e)),j.relates(e,D(t))}function J(t,e){j.fulfillment(e,Q(t))}function F(t){return function(e,n){t.rel.details(e,t.model.details(n.id,j.desc(n),U(j.timestamp(n),j.data(n)))),j.participants(n,I(t)),j.evidences(n,K(t))}}function I(t){return function(e,n){var r=j.role.is(n.id)?t.model.role(j.role.name(n.id)):t.model.participant(n.id);t.rel.participant(e,r)}}function N(t){return function(e,n){if(!j.role.is(n.id))throw g.message.roleRequired(e);t.rel.plays(e,t.model.role(j.role.name(n.id)))}}function D(t){return function(e,n){j.role.is(n.id)?t.rel.relates(e,t.model.role(j.role.name(n.id))):t.rel.relates(e,t.model.participant(n.id))}}function K(t){return function(e,n){t.rel.evidence(e,t.model.evidence(n.id))}}function Q(t){function e(t,e){return t.split(_).concat(e).join(" ")}function n(t,e){if(!t)return e;var n=j.name(t);return n||e}function r(t){return t?U(j.timestamp(t),j.data(t)):[]}function a(t,e,n){n&&V(t,k(n,e.id))}return function(i,o){var c=t.model.fulfillmentRequest(n(o.request,e(o.id,"Request")),j.desc(o),r(o.request)),s=t.model.fulfillmentConfirmation(n(o.confirm,e(o.id,"Confirmation")),!!o.confirm&&j.variform(o.confirm),r(o.confirm));a(t,c,o.request),a(t,s,o.confirm),t.rel.fulfillment(i,c),t.rel.confirmation(c,s)}}function U(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce((function(t,e){return t.concat(e)}))}function W(t,e,n){var r=[];try{T(t)}catch(i){var a=n&&n.getCursor()?n.getCursor().line:0;r.push({from:d.a.Pos(a,0),to:d.a.Pos(a,0),message:i})}return r}d.a.registerHelper("lint","yaml",W);var X={name:"script-editor",data:function(){return{script:""}},props:["yaml"],mounted:function(){var t=this;this.editor=d.a.fromTextArea(this.$refs.textarea,{mode:"text/yaml",theme:"panda-syntax",lineNumbers:!0,line:!0,tabSize:2,gutters:["CodeMirror-lint-markers"],lint:!0}),this.editor.setValue(this.yaml||this.script),this.editor.on("change",(function(e){t.script=e.getValue(),t.editor.performLint(),t.$emit("input",t.script)}))},watch:{yaml:function(t){this.editor.setValue(t),this.editor.performLint()}}},Y=X,Z=(n("4207"),n("2877")),tt=Object(Z["a"])(Y,u,l,!1,null,null,null),et=tt.exports,nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",staticClass:"model-viewer"})},rt=[],at=(n("cb29"),n("e9ec")),it=n.n(at),ot=n("dab9"),ct=n("90f7");function st(t){return it()({models:{defaults:{shape:{width:400,height:300,corner_radius:10,scale:.2},archetype:{color:"white",family:'"Arial Black", sans-serif',size:25},name:{color:"white",family:"Impact, sans-serif",size:40},attributes:{color:"white",family:'"Helvetica", sans-serif',size:25},fill:"rgb(229, 59, 112)"},party:{fill:"rgb(103, 157, 52)"},place:{fill:"rgb(103, 157, 52)"},thing:{fill:"rgb(103, 157, 52)"},participant:{fill:"rgb(103, 157, 52)"},domain:{fill:"rgb(254, 180, 63)"},system:{fill:"rgb(254, 180, 63)"},role:{fill:"rgb(254, 180, 63)"},variform:{fill:"rgb(254, 180, 63)"}},relationships:{defaults:{color:"rgb(229, 59, 112)",width:2,opacity:.8,dash:""},participant:{color:"rgb(254, 180, 63)",width:1.5,opacity:.6},plays:{color:"rgb(153, 153, 153)",width:1,opacity:.6,dash:"10,10"},relates:{color:"rgb(103, 157, 52)",width:1,opacity:.6}},view:{width:1e3,height:1e3}},t||{})}function ut(t,e,n){return t.selectAll("g.model").data(e).join("g").each(lt(n)).attr("class",(function(t){return"model ".concat(t.archetype)})).attr("id",(function(t){return t.id}))}function lt(t){return function(e){var n=mt(e,t);pt(this,e,n),ft(this,e,n)}}function ft(t,e,n){(new ct["a"]).data(dt(e,n)).width(n.shape.width).height(n.shape.height).fontResize((function(t){return t.resize})).fontColor((function(t){return t.font.color})).fontSize((function(t){return t.font.size})).fontFamily((function(t){return t.font.family})).verticalAlign("middle").textAnchor("middle").y((function(t,e){return(e-1)*n.shape.height/3})).select(t).render()}function dt(t,e){return[{text:["<",t.archetype,">"].join(" "),resize:!1,font:e.archetype},{text:t.id,resize:!0,font:e.name},{text:t.attributes.map((function(t){return t.name})).join(" "),resize:!1,font:e.attributes}]}function pt(t,e,n){Object(ot["a"])(t).append("rect").attr("class","background").attr("x",0).attr("y",0).attr("width",n.shape.width).attr("height",n.shape.height).attr("rx",n.shape.corner_radius).attr("ry",n.shape.corner_radius).attr("fill",n.fill)}function mt(t,e){return it()({},e.models.defaults,e.models[t.archetype]||{})}function ht(t,e,n){return t.append("g").selectAll("line").data(e).join("line").attr("stroke",(function(t){return vt(t,n).color})).attr("stroke-width",(function(t){return vt(t,n).width})).attr("stroke-opacity",(function(t){return vt(t,n).opacity})).attr("stroke-dasharray",(function(t){return vt(t,n).dash}))}function vt(t,e){return it()({},e.relationships.defaults,e.relationships[t.type]||{})}function yt(t,e,n){var r=st(n),a=t.append("svg").attr("viewBox",[0,0,r.view.width,r.view.height]).attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink"),i=a.append("g"),o=ht(i,e.relationships,r),c=ut(i,e.models,r);return{svg:a,group:i,nodes:c,links:o,options:r,tick:function(){o.attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),c.attr("transform",(function(t){var e=it()({},r.models.defaults,r.models[t.archetype]||{}),n=e.shape.width/2*e.shape.scale,a=e.shape.height/2*e.shape.scale;return"translate(".concat(t.x-n,", ").concat(t.y-a,") scale(").concat(e.shape.scale,", ").concat(e.shape.scale,")")}))},remove:function(){a.remove()}}}function gt(t,e){var n=yt(t,e.data,e.options);return e.view(n),n}var bt=n("00a5"),wt=n("0a4a"),xt=n("d934"),kt=n("009f"),_t=n("0165");function jt(t){return Object(kt["a"])().on("start",(function(e){_t["c"].active||t.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y})).on("drag",(function(t){t.fx=_t["c"].x,t.fy=_t["c"].y})).on("end",(function(e){_t["c"].active||t.alphaTarget(0),e.fx=null,e.fy=null}))}function Ct(t){return function(){return t.group.attr("transform",_t["c"].transform)}}var Ot={name:"model-viewer",props:["graph"],data:function(){return{bom:{models:[],relationships:[]}}},mounted:function(){this.render(this.graph||this.bom)},watch:{graph:function(t){this.chart.remove(),this.render(t)}},methods:{render:function(t){this.chart=gt(Object(bt["a"])(this.$refs.container),{data:t,view:function(t){var e=Object(wt["d"])(t.nodes.data()).force("link",Object(wt["b"])(t.links.data()).id((function(t){return t.id})).distance(90)).force("charge",Object(wt["c"])().strength(-300)).force("center",Object(wt["a"])(t.options.view.width/2,t.options.view.height/2)).on("tick",t.tick);t.nodes.call(jt(e)),t.svg.call(Object(xt["a"])().extent([[0,0],[t.options.view.width,t.options.view.height]]).scaleExtent([.025,2.5]).on("zoom",Ct(t)))}})}}},St=Ot,At=(n("c993"),Object(Z["a"])(St,nt,rt,!1,null,null,null)),Et=At.exports,qt=n("21a6"),zt={name:"model-editor",components:{ModelViewer:Et,ScriptEditor:et},data:function(){return{logo:s.a,yaml:"",cached_graph:{models:[],relationships:[]},examples:[]}},beforeMount:function(){this.loadExamples()},computed:{graph:function(){try{this.cached_graph=T(this.yaml)}catch(t){}return this.cached_graph}},methods:{downloadScript:function(){Object(qt["saveAs"])(new Blob([this.yaml],{type:"text/plain;charset=utf-8"}),"models.yaml")},downloadGraph:function(){var t='<?xml version="1.0" standalone="no"?>\r\n'.concat(this.$refs.viewer.$el.querySelector("svg").outerHTML);Object(qt["saveAs"])(new Blob([t],{type:"image/svg+xml;charset=utf-8"}),"models.svg")},loadExample:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,fetch(t);case 2:return r=n.sent,n.next=5,r.text();case 5:e.yaml=n.sent;case 6:case"end":return n.stop()}}),n)})))()},loadExamples:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("/8x-flow/examples/index.json");case 2:return n=e.sent,e.next=5,n.json();case 5:t.examples=e.sent;case 6:case"end":return e.stop()}}),e)})))()}}},$t=zt,Rt=(n("4868"),Object(Z["a"])($t,a,i,!1,null,null,null)),Pt=Rt.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(t){return t(Pt)}}).$mount("#app")},"7e9e":function(t,e,n){},b804:function(t,e,n){},c993:function(t,e,n){"use strict";var r=n("7e9e"),a=n.n(r);a.a}});
//# sourceMappingURL=app.5faee481.js.map